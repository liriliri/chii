import{AnimationGroup}from"./AnimationModel.js";import{AnimationUI}from"./AnimationUI.js";export class AnimationGroupPreviewUI{constructor(t){this._model=t,this.element=createElementWithClass("div","animation-buffer-preview"),this.element.createChild("div","animation-paused fill"),this._removeButton=this.element.createChild("div","animation-remove-button"),this._removeButton.textContent="âœ•",this._replayOverlayElement=this.element.createChild("div","animation-buffer-preview-animation"),this._svg=this.element.createSVGChild("svg"),this._svg.setAttribute("width","100%"),this._svg.setAttribute("preserveAspectRatio","none"),this._svg.setAttribute("height","100%"),this._viewBoxHeight=32,this._svg.setAttribute("viewBox","0 0 100 "+this._viewBoxHeight),this._svg.setAttribute("shape-rendering","crispEdges"),this._render()}_groupDuration(){let t=0;for(const e of this._model.animations()){const i=e.source().delay()+e.source().duration();i>t&&(t=i)}return t}removeButton(){return this._removeButton}replay(){this._replayOverlayElement.animate([{offset:0,width:"0%",opacity:1},{offset:.9,width:"100%",opacity:1},{offset:1,width:"100%",opacity:0}],{duration:200,easing:"cubic-bezier(0, 0, 0.2, 1)"})}_render(){this._svg.removeChildren();const t=Math.min(this._model.animations().length,10),e=100/Math.max(this._groupDuration(),750);for(let i=0;i<t;i++){const o=this._model.animations()[i].source(),s=this._svg.createSVGChild("line");s.setAttribute("x1",o.delay()*e),s.setAttribute("x2",(o.delay()+o.duration())*e);const n=Math.floor(this._viewBoxHeight/Math.max(6,t)*i+1);s.setAttribute("y1",n),s.setAttribute("y2",n),s.style.stroke=AnimationUI.Color(this._model.animations()[i])}}}